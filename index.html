<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Free Text-to-Speech Reader | Convert Text to Speech Online</title>
  <meta name="description" content="Convert any text to speech instantly with our free, no-sign-up tool. Multiple languages, natural voices, and simple controls. Start reading aloud now!">
  <link rel="canonical" href="https://read-aloud.com/">

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css">

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4003447295960802" crossorigin="anonymous"></script>

  <!-- Search Console -->
  <meta name="google-site-verification" content="ndECWtgXIkiPKk8wKFXTkCd2JSwMnWBKZ4H2uOtQpjY">

  <!-- Google Tag Manager -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SVGML1VGPG"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-SVGML1VGPG');
  </script>
</head>

<body>
  <!-- COOKIE CONSENT BANNER (required for AdSense personalisation) -->
  <div id="cookie-banner" style="position:fixed;bottom:0;left:0;right:0;padding:1rem;background:#f5f5f5;border-top:1px solid #ddd;display:none;font-family:Arial,sans-serif;font-size:.9rem;z-index:9999">
    We use cookies to personalise content and ads. <button id="cookie-accept" style="margin-left:.5rem">Accept</button>
  </div>
  <script>
    (function(){
      if(localStorage.getItem('cookieAccepted')!=='yes'){
        document.getElementById('cookie-banner').style.display='block';
        document.getElementById('cookie-accept').onclick=function(){
          localStorage.setItem('cookieAccepted','yes');
          document.getElementById('cookie-banner').style.display='none';
        };
      }
    })();
  </script>

  <!-- HEADER -->
  <header>
    <div class="container">
      <div class="logo">Read-Aloud</div>
      <nav role="navigation" aria-label="Main Navigation">
        <ul>
          <li><a href="index.html" class="active">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="#tool-interface">Tool</a></li>
          <li><a href="blog.html">Blog</a></li>
          <li><a href="how-it-works.html">How It Works</a></li>
          <li><a href="faq.html">FAQ</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section id="hero">
    <div class="container">
      <h1>Free Text-to-Speech Reader</h1>
      <p>Convert any text into natural-sounding speech instantlyâ€”no sign-up, unlimited usage!</p>
      <a href="#tool-interface" class="btn" aria-label="Skip to tool interface">Try It Now</a>

      <!-- AdSense â€“ replace YOUR_AD_SLOT with the slot ID shown in AdSense -->
      <div class="ad-container" style="margin:20px 0">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-4003447295960802"
             data-ad-slot="YOUR_AD_SLOT"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      </div>
    </div>
  </section>

  <!-- TOOL -->
  <main id="tool-interface">
    <div class="container">
      <h2>Try It Out</h2>

      <label for="textInput" class="visually-hidden">Enter text</label>
      <textarea id="textInput" aria-label="Enter text for text-to-speech"
                placeholder="Type or paste your text hereâ€¦"></textarea>

      <br>

      <label for="languageSelect">Select Language:</label>
      <select id="languageSelect" onchange="filterVoicesByLanguage()">
        <option value="en" selected>English</option>
        <option value="es">Spanish</option>
        <option value="fr">French</option>
        <option value="de">German</option>
        <option value="it">Italian</option>
      </select>

      <br>

      <label for="voiceSelect">Select Voice:</label>
      <select id="voiceSelect">
        <option value="-1">Default Voice (Fallback)</option>
      </select>

      <br>

      <label for="rateControl">Reading Speed:</label>
      <input type="range" id="rateControl" min="0.5" max="2" step="0.1" value="1" onchange="updateRate(this.value)">
      <span id="rateValue">1</span>

      <div class="button-container">
        <button aria-label="Start reading"   onclick="startReading(true)">Start</button>
        <button aria-label="Pause reading"   onclick="pauseReading()">Pause</button>
        <button aria-label="Resume reading"  onclick="resumeReading()">Resume</button>
        <button aria-label="Stop reading"    onclick="stopReading()">Stop</button>
      </div>

      <div id="textDisplay" aria-live="polite"></div>

      <div id="progressContainer" aria-live="polite">
        <p><strong>Progress:</strong> <span id="progressPercent">0%</span></p>
        <p><strong>Time Elapsed:</strong> <span id="timeElapsed">00:00:00</span></p>
        <p><strong>Time Remaining:</strong> <span id="timeRemaining">00:00:00</span></p>
      </div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer>
    <div class="container">
      <p>&copy; 2025 Read-Aloud.com. All rights reserved.</p>
      <nav role="navigation" aria-label="Secondary Navigation">
        <ul>
          <li><a href="privacy.html">Privacy Policy</a></li>
          <li><a href="terms.html">Terms of Use</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </footer>

  <!-- ==================== JavaScript ==================== -->
  <script>
    /* -------------- CONFIG ---------------- */
    const useVoiceRSSFallback = true;

    /* -------------- GLOBALS --------------- */
    let speechSynthesisUtterance, voices = [], startWordIndex = 0,
        previousText = "", readingStartTime = null, cachedSpans = null;

    const textDisplay      = document.getElementById('textDisplay');
    const textInput        = document.getElementById('textInput');
    const voicesDropdown   = document.getElementById('voiceSelect');
    const languageDropdown = document.getElementById('languageSelect');
    const rateControl      = document.getElementById('rateControl');
    const rateValue        = document.getElementById('rateValue');
    const progressPercent  = document.getElementById('progressPercent');
    const timeElapsed      = document.getElementById('timeElapsed');
    const timeRemaining    = document.getElementById('timeRemaining');

    const regionalVoicePriority = {
      "en-US": ["Samantha","Alex"],
      "en-GB": ["Daniel","Serena","Moira"],
      "en-AU": ["Karen","Russell"],
      "fr-FR": ["Thomas","Audrey"],
      "de-DE": ["Hans","Marlene"],
      "it-IT": ["Alice","Luca"]
    };

    let excludedVoices = [];
    let voiceRSSApiKey = null;
    let fallbackAudio  = null;

    /* ----------- EXCLUDED VOICES ---------- */
    function updateExcludedVoices(v){ excludedVoices = v; }
    updateExcludedVoices(["Jester","Organ","Bubbles","Bad News","Boing","Wobble","Grandma","Grandpa","Rocko","Shelley","Flo","Eddy","Reed"]);

    /* -------------- LOAD KEY -------------- */
    async function loadApiKey(){
      try{
        const r = await fetch("api_key.json");
        if(!r.ok) throw new Error();
        const d = await r.json();
        voiceRSSApiKey = d.VoiceRSS_API_Key || null;
      }catch(e){
        console.warn("VoiceRSS key missing");
      }
    }

    /* ---------- VOICE DROPDOWN ------------ */
    function precomputeVoiceFilters(lang){
      const pri = regionalVoicePriority[`${lang}-US`] || [];
      const out = {pri:[],rest:[]};
      voices.forEach((v,i)=>{
        if(excludedVoices.some(x=>v.name.includes(x))) return;
        if(pri.includes(v.name)){
          out.pri.push({i,html:`<option value="${i}" selected>ðŸŒŸ ${v.name} (${v.lang})</option>`});
        }else if(v.lang.startsWith(lang)){
          out.rest.push({i,html:`<option value="${i}">${v.name} (${v.lang})</option>`});
        }
      });
      return out;
    }
    function filterVoicesByLanguage(){
      const lang = languageDropdown.value;
      const {pri,rest} = precomputeVoiceFilters(lang);
      voicesDropdown.innerHTML = `<option value="-1">Default Voice (Fallback)</option>` + pri.map(o=>o.html).join('') + rest.map(o=>o.html).join('');
    }

    /* ---------- DISPLAY & HIGHLIGHT ------- */
    function updateTextDisplay(){
      const t = textInput.value;
      if(t !== previousText){
        textDisplay.innerHTML = t.split(/(\s+)/).map((w,i)=>`<span data-index="${i}">${w}</span>`).join('');
        textDisplay.style.display = 'block';
        previousText = t;
        cachedSpans  = textDisplay.querySelectorAll('span');
        cachedSpans.forEach(s=>s.addEventListener('click',()=>{
          startWordIndex = +s.dataset.index;
          if(speechSynthesis.speaking) speechSynthesis.cancel();
          highlightWord(startWordIndex);
          startReading(false);
        }));
      }
    }
    function highlightWord(i){
      cachedSpans.forEach(s=>s.classList.remove('highlight'));
      if(cachedSpans[i]) cachedSpans[i].classList.add('highlight');
    }

    /* -------------- PROGRESS -------------- */
    function formatTime(s){
      const h = String(Math.floor(s/3600)).padStart(2,'0'),
            m = String(Math.floor(s%3600/60)).padStart(2,'0'),
            sec = String(Math.floor(s%60)).padStart(2,'0');
      return `${h}:${m}:${sec}`;
    }
    function updateProgress(i,total){
      progressPercent.textContent = `${Math.round(i/total*100)}%`;
      const elapsed = Math.floor((Date.now()-readingStartTime)/1000);
      const est = Math.round((total-i)*0.5);
      timeElapsed.textContent = formatTime(elapsed);
      timeRemaining.textContent = formatTime(est);
    }
    function resetProgress(){
      progressPercent.textContent='0%';
      timeElapsed.textContent='00:00:00';
      timeRemaining.textContent='00:00:00';
    }

    /* ---------- VoiceRSS Fallback --------- */
    async function speakWithVoiceRSS(text,lang,rate){
      if(!voiceRSSApiKey){ alert("VoiceRSS key missing"); return; }
      if(fallbackAudio) fallbackAudio.pause();
      const mapped = Math.round(((rate-0.5)/1.5)*10-5);
      const url = `https://api.voicerss.org/?key=${encodeURIComponent(voiceRSSApiKey)}&hl=${lang}&r=${mapped}&c=MP3&f=44khz_16bit_stereo&src=${encodeURIComponent(text)}`;
      const res = await fetch(url);
      if(!res.ok){ alert("VoiceRSS error"); return; }
      const blob = await res.blob();
      fallbackAudio = new Audio(URL.createObjectURL(blob));
      fallbackAudio.play();
      readingStartTime = Date.now();
      const totalWords = text.split(/\s+/).length;
      const itv = setInterval(()=>{
        if(!fallbackAudio || fallbackAudio.paused){ clearInterval(itv); return; }
        const idx = Math.min(Math.floor((Date.now()-readingStartTime)/500), totalWords);
        updateProgress(idx,totalWords);
      },500);
      fallbackAudio.onended = () => { resetProgress(); clearInterval(itv); };
    }

    /* -------------- CONTROLS ------------- */
    function updateRate(v){ rateValue.textContent = v; }
    function pauseReading(){ speechSynthesis.pause(); if(fallbackAudio) fallbackAudio.pause(); }
    function resumeReading(){ if(speechSynthesis.paused) speechSynthesis.resume(); if(fallbackAudio) fallbackAudio.play(); }
    function stopReading(){
      speechSynthesis.cancel();
      if(fallbackAudio){ fallbackAudio.pause(); fallbackAudio=null; }
      cachedSpans && cachedSpans.forEach(s=>s.classList.remove('highlight'));
      resetProgress();
    }

    /* -------------- START ---------------- */
    function startReading(reset=true){
      const text = textInput.value.trim();
      if(!text){ alert('Please enter text.'); return; }
      stopReading(); if(reset){ startWordIndex=0; resetProgress(); }

      const selVoiceIdx = +voicesDropdown.value;
      const localOK = voices.length>0 && selVoiceIdx!==-1;
      if(useVoiceRSSFallback && !localOK){
        speakWithVoiceRSS(text,languageDropdown.value, +rateControl.value);
        return;
      }
      const words = text.split(/(\s+)/);
      const selTxt = words.slice(startWordIndex).join('');
      speechSynthesisUtterance = new SpeechSynthesisUtterance(selTxt);
      if(localOK) speechSynthesisUtterance.voice = voices[selVoiceIdx];
      speechSynthesisUtterance.rate = +rateControl.value;
      const total = words.length;
      readingStartTime = Date.now();
      speechSynthesisUtterance.onboundary = e=>{
        let chars=0;
        for(let i=startWordIndex;i<cachedSpans.length;i++){
          chars += cachedSpans[i].textContent.length;
          if(chars>e.charIndex){ highlightWord(i); updateProgress(i,total); break; }
        }
      };
      speechSynthesisUtterance.onend = ()=>{ cachedSpans.forEach(s=>s.classList.remove('highlight')); resetProgress(); };
      speechSynthesis.speak(speechSynthesisUtterance);
    }

    /* -------------- INIT ----------------- */
    textInput.addEventListener('input', updateTextDisplay);
    speechSynthesis.addEventListener('voiceschanged', populateVoices);
    async function populateVoices(attempt=0){
      voices = speechSynthesis.getVoices();
      if(!voices.length && attempt<5) return setTimeout(()=>populateVoices(attempt+1),200<<attempt);
      filterVoicesByLanguage();
    }
    loadApiKey().then(populateVoices);
  </script>
</body>
</html>
