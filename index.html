<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Free Text-to-Speech Reader | Convert Text to Speech Online</title>

  <!-- SEO -->
  <link rel="canonical" href="https://read-aloud.com/">
  <meta name="description" content="Convert any text into natural-sounding speech instantly with our free, no-sign-up tool. Multiple languages, natural voices, and simple controls. Start reading aloud now!">
  <meta property="og:title" content="Free Text-to-Speech Reader">
  <meta property="og:description" content="Convert any text into speech in seconds—no sign-up, unlimited usage.">
  <meta property="og:image" content="https://read-aloud.com/thumbnail.png">
  <meta property="og:url" content="https://read-aloud.com/">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css">

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4003447295960802" crossorigin="anonymous"></script>
  <meta name="google-site-verification" content="ndECWtgXIkiPKk8wKFXTkCd2JSwMnWBKZ4H2uOtQpjY">

  <!-- Google Tag Manager -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SVGML1VGPG"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-SVGML1VGPG');
  </script>

  <!-- Critical CSS for banner & progress -->
  <style>
    #cookie-banner{position:fixed;bottom:0;left:0;right:0;padding:1rem;background:#f5f5f5;border-top:1px solid #ccc;font:14px/1.4 Arial,sans-serif;z-index:1000;display:none}
    #cookie-banner button{margin-left:.5rem}
    .highlight{background:#ff0}
    progress{width:100%;height:8px;margin:6px 0;border:0;background:#eee}
    progress::-webkit-progress-value{background:#4caf50}
  </style>
</head>
<body>
  <!-- GDPR / CCPA banner -->
  <div id="cookie-banner">We use cookies to personalise content and ads. <button id="cookie-accept">Accept</button></div>
  <script>
    if(localStorage.getItem('cookieAccepted')!=='yes'){
      const b=document.getElementById('cookie-banner');
      b.style.display='block';
      document.getElementById('cookie-accept').onclick=()=>{localStorage.setItem('cookieAccepted','yes');b.remove();};
    }
  </script>

  <!-- HEADER -->
  <header>
    <div class="container">
      <div class="logo">Read-Aloud</div>
      <nav role="navigation" aria-label="Main">
        <ul>
          <li><a href="index.html" class="active">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="#tool-interface">Tool</a></li>
          <li><a href="blog.html">Blog</a></li>
          <li><a href="how-it-works.html">How It Works</a></li>
          <li><a href="faq.html">FAQ</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section id="hero">
    <div class="container">
      <h1>Free Text-to-Speech Reader</h1>
      <p>Convert any text into natural-sounding speech instantly—no sign-up, unlimited usage!</p>
      <a href="#tool-interface" class="btn">Try It Now</a>

      <!-- Ad unit (slot unchanged) -->
      <div style="margin:20px 0">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-4003447295960802"
             data-ad-slot="YOUR_AD_SLOT"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
      </div>
    </div>
  </section>

  <!-- TOOL -->
  <main id="tool-interface">
    <div class="container">
      <h2>Try It Out</h2>

      <textarea id="textInput" placeholder="Type or paste your text here…" aria-label="Text to read"></textarea>

      <label for="languageSelect">Language:</label>
      <select id="languageSelect"></select>

      <label for="voiceSelect">Voice (click to preview):</label>
      <select id="voiceSelect"><option value="-1">Default</option></select>

      <label for="rateControl">Speed: <span id="rateValue">1</span>x</label>
      <input type="range" id="rateControl" min="0.5" max="2" step="0.1" value="1">

      <div class="button-container">
        <button id="startBtn">Start (S)</button>
        <button id="pauseBtn">Pause (P)</button>
        <button id="resumeBtn">Resume (R)</button>
        <button id="stopBtn">Stop (X)</button>
      </div>

      <progress id="progressBar" value="0" max="100" aria-label="Reading progress"></progress>
      <div id="progressText"><strong>0%</strong> – <span id="timeElapsed">00:00:00</span> elapsed / <span id="timeRemaining">00:00:00</span> left</div>

      <div id="textDisplay" aria-live="polite"></div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer>
    <div class="container">
      <p>&copy; 2025 Read-Aloud.com.</p>
      <nav aria-label="Legal">
        <ul>
          <li><a href="privacy.html">Privacy</a></li>
          <li><a href="terms.html">Terms</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </footer>

  <!-- ========== JavaScript ========== -->
  <script>
    /* ------- CONFIG -------- */
    const useVoiceRSSFallback=true, chunkSize=3000, samplePhrase='Hello';

    /* ------- DOM refs ------- */
    const $=id=>document.getElementById(id),
          txtInput=$('textInput'), langSel=$('languageSelect'), voiceSel=$('voiceSelect'),
          rate=$('rateControl'), rateVal=$('rateValue'),
          startBtn=$('startBtn'), pauseBtn=$('pauseBtn'), resumeBtn=$('resumeBtn'), stopBtn=$('stopBtn'),
          bar=$('progressBar'), pText=$('progressText'), elapsed=$('timeElapsed'), remain=$('timeRemaining'),
          display=$('textDisplay');

    /* ------- STATE --------- */
    let voices=[], utter=null,startIdx=0, spans=[], prev='',startTime=0,fallbackAudio=null,key=null;

    /* ------- INIT ---------- */
    document.addEventListener('DOMContentLoaded', async ()=>{
      loadSettings();
      txtInput.addEventListener('input',autoSizeAndDisplay); autoSizeAndDisplay();
      rate.addEventListener('input',()=>{rateVal.textContent=rate.value;saveSettings();});
      langSel.addEventListener('change',()=>{filterVoices();saveSettings();});
      voiceSel.addEventListener('change',previewVoice);
      document.addEventListener('keydown',hotkeys);
      startBtn.onclick=()=>startReading(true); pauseBtn.onclick=pauseReading; resumeBtn.onclick=resumeReading; stopBtn.onclick=stopReading;
      await loadApiKey(); populateLanguages(); populateVoices();
    });

    /* ------- Settings ------- */
    function saveSettings(){localStorage.setItem('rl_lang',langSel.value);localStorage.setItem('rl_voice',voiceSel.value);localStorage.setItem('rl_rate',rate.value);}
    function loadSettings(){rate.value=localStorage.getItem('rl_rate')||'1';rateVal.textContent=rate.value;}

    /* ------- Hot-keys ------ */
    function hotkeys(e){
      if(e.target.tagName==='TEXTAREA')return;
      const k=e.key.toLowerCase();
      if(k==='s')startReading(true); else if(k==='p')pauseReading(); else if(k==='r')resumeReading(); else if(k==='x')stopReading();
    }

    /* ---- Auto-resize & span wrap ---- */
    function autoSizeAndDisplay(){
      txtInput.style.height='auto'; txtInput.style.height=txtInput.scrollHeight+'px';
      const t=txtInput.value; if(t===prev)return;
      display.innerHTML=t.split(/(\s+)/).map((w,i)=>`<span data-i="${i}">${w}</span>`).join('');
      spans=[...display.querySelectorAll('span')];
      spans.forEach(s=>s.onclick=()=>{startIdx=+s.dataset.i;highlight(startIdx);startReading(false);});
      prev=t;
    }
    function highlight(i){spans.forEach(s=>s.classList.remove('highlight')); if(spans[i])spans[i].classList.add('highlight');}

    /* ---- Voices ---- */
    function populateLanguages(){['en','es','fr','de','it'].forEach(l=>{const o=document.createElement('option');o.value=l;o.text={'en':'English','es':'Spanish','fr':'French','de':'German','it':'Italian'}[l];langSel.appendChild(o);});langSel.value=localStorage.getItem('rl_lang')||'en';}
    function populateVoices(a=0){voices=speechSynthesis.getVoices();if(!voices.length&&a<5)return setTimeout(()=>populateVoices(a+1),200<<a);filterVoices();voiceSel.value=localStorage.getItem('rl_voice')||'-1';}
    speechSynthesis.addEventListener('voiceschanged',populateVoices);
    function filterVoices(){const lang=langSel.value;voiceSel.innerHTML='<option value="-1">Default</option>';voices.filter(v=>v.lang.startsWith(lang)).forEach((v,i)=>{const o=document.createElement('option');o.value=i;o.textContent=v.name;voiceSel.appendChild(o);});}
    function previewVoice(){if(voiceSel.value==='-1')return;const u=new SpeechSynthesisUtterance(samplePhrase);u.voice=voices[voiceSel.value];u.rate=rate.value;speechSynthesis.speak(u);}

    /* ---- API key ---- */
    async function loadApiKey(){try{key=(await (await fetch('api_key.json')).json()).VoiceRSS_API_Key;}catch{}}

    /* ---- Controls ---- */
    function pauseReading(){speechSynthesis.pause();if(fallbackAudio)fallbackAudio.pause();}
    function resumeReading(){if(speechSynthesis.paused)speechSynthesis.resume();if(fallbackAudio)fallbackAudio.play();}
    function stopReading(){speechSynthesis.cancel();if(fallbackAudio){fallbackAudio.pause();fallbackAudio=null;}reset();}
    function reset(){highlight();bar.value=0;pText.querySelector('strong').textContent='0%';elapsed.textContent='00:00:00';remain.textContent='00:00:00';}

    /* ---- Reading ---- */
    function splitText(t){return t.match(new RegExp('[\\s\\S]{1,'+chunkSize+'}(?:\\s|$)','g'))||[];}
    function startReading(resetPos=true){
      const txt=txtInput.value.trim();if(!txt){alert('Enter some text first');return;}
      if(resetPos){startIdx=0;reset();} stopReading();
      const chunks=splitText(txt);
      if(useVoiceRSSFallback&&(!voices.length||voiceSel.value==='-1'))return speakFallback(chunks.join(' '));
      readChunks(chunks);
    }
    function readChunks(chunks){
      if(!chunks.length)return;
      utter=new SpeechSynthesisUtterance(chunks.shift());
      if(voiceSel.value!=='-1'&&voices[voiceSel.value])utter.voice=voices[voiceSel.value];
      utter.rate=rate.value;startTime=Date.now();
      utter.onend=()=>readChunks(chunks);
      utter.onboundary=e=>updateProgress(e.charIndex,txtInput.value.length);
      speechSynthesis.speak(utter);
    }
    async function speakFallback(text){
      if(!key){alert('VoiceRSS key missing');return;}
      const r=Math.round(((rate.value-0.5)/1.5)*10-5);
      const url=`https://api.voicerss.org/?key=${key}&hl=${langSel.value}&c=MP3&r=${r}&src=${encodeURIComponent(text)}`;
      const blob=await (await fetch(url)).blob();fallbackAudio=new Audio(URL.createObjectURL(blob));fallbackAudio.play();startTime=Date.now();
      const total=text.split(/\s+/).length,timer=setInterval(()=>{if(!fallbackAudio||fallbackAudio.paused)return clearInterval(timer);const idx=Math.min(Math.floor((Date.now()-startTime)/500),total);updateProgress(idx,txtInput.value.length);},500);
      fallbackAudio.onended=()=>{clearInterval(timer);reset();};
    }
    function updateProgress(chars,totalChars){
      const pct=Math.round(chars/totalChars*100);bar.value=pct;pText.querySelector('strong').textContent=pct+'%';
      const el=Math.floor((Date.now()-startTime)/1000),rem=Math.round((totalChars-chars)/(chars?chars/el:1));
      elapsed.textContent=formatTime(el);remain.textContent=formatTime(rem);
    }
    function formatTime(s){const h=String(Math.floor(s/3600)).padStart(2,'0'),m=String(Math.floor(s%3600/60)).padStart(2,'0'),sec=String(Math.floor(s%60)).padStart(2,'0');return`${h}:${m}:${sec}`;}
  </script>
</body>
</html>
